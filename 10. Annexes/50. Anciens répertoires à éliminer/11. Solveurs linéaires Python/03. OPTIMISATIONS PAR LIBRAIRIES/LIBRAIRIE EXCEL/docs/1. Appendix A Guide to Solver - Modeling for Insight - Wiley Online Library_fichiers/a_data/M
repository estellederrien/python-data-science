var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),PostType,DataWrapper;(function(n){n[n.OnLoad=0]="OnLoad";n[n.OnBeforeUnload=1]="OnBeforeUnload";n[n.OnAbort=2]="OnAbort";n[n.Flush=3]="Flush"})(PostType||(PostType={}));DataWrapper=function(){function n(){this.hasErrors=!1;this._appErrors=null;this.hasIndicators=!1;this._indicators=null;this.hasTracepoints=!1;this._tracepoints=null}return n.prototype.addError=function(n,t){this.hasErrors||(this._appErrors={},this.hasErrors=!0);this._appErrors[n]=t},n.prototype.getErrors=function(){return this._appErrors},n.prototype.addIndicator=function(n){this.hasIndicators||(this._indicators={},this.hasIndicators=!0);for(var t in n)this._indicators[t]=n[t]},n.prototype.getIndicators=function(){return this._indicators},n.prototype.addTracepoint=function(n){this.hasTracepoints||(this._tracepoints={},this.hasTracepoints=!0);for(var t in n)this._tracepoints[t]=n[t]},n.prototype.getTracepoints=function(){return this._tracepoints},n}(),function(){var l,i;if(document.getElementById&&(window.attachEvent||window.addEventListener)){var n=parent.window,s=n.location,t=n.RProfiler,o=n.WindowEvent,a=s.protocol+"//",st=t.version,e=typeof n.performance=="object",h=e&&typeof n.performance.getEntriesByType=="function",c={Load:o.Load,BeforeUnload:o.BeforeUnload,Unload:o.Unload,Abort:o.Abort,Error:o.Error},v="test",g="v3.2.1",r={sampleRate:10,waterfallSampleRate:1,postUrl:a+"r.3gl.net/hawklogserver/r.p",siteId:1084,debugParameter:"GlimpseDebug",debugUrl:"g.3gl.net/jp/v3.2.1/D",waterfallParameter:"GlimpseWaterfall",sendOnLoad:!1,clearResources:!0},y=function(){return(new Date).getTime()};!n.__cpPostUrl||(r.postUrl=n.__cpPostUrl.trim());!n.__cpSendOnLoad||(r.sendOnLoad=n.__cpSendOnLoad===!0);var nt=function(){function t(){var t=this;this.longTaskEndTime=0;this.waitTime=5e3;this.performanceObserverApi=n.PerformanceObserver;this.performanceLongTaskTiming=n.PerformanceLongTaskTiming;this.observeLongTask=function(n){for(var r,u,i=0;i<n.length;i++)r=n[i],i>0?(u=n[i-1],t.longTaskEndTime=r.startTime-u.startTime>t.waitTime?t.setLongTaskTime(u):t.setLongTaskTime(r)):t.longTaskEndTime=t.setLongTaskTime(r)};this.setLongTaskTime=function(n){return Math.round(n.startTime+n.duration)};this.getLongTaskTime=function(){return t.longTaskEndTime};this.performanceLongTaskTiming&&this.observe(["longtask"],this.observeLongTask)}return t.prototype.observe=function(n,t){if(this.performanceObserverApi){var i=new this.performanceObserverApi(function(n){var i=n.getEntries();t(i)});i.observe({entryTypes:n})}},t}(),tt=new nt,p=function(){function t(){}return t.save=function(i){if(t.canUseLocalStorage()){n.localStorage.setItem(t.storeKey,i);return}t.setCookie(i)},t.read=function(){if(t.canUseLocalStorage()){var i=n.localStorage.getItem(t.storeKey);if(i)return i}return this.readCookie()},t.canUseLocalStorage=function(){var r=!0,i,u,f;try{i=t.storeKey+"delete";u=i+0;n.localStorage.setItem(i,u);f=n.localStorage.getItem(i);r=u===f;r&&n.localStorage.removeItem(i)}catch(e){r=!1}return r},t.setCookie=function(i){var r=new Date;r.setTime(r.getTime()+t.cookieExpireDays*864e5);var e="; expires="+r.toUTCString(),u=n.document.domain.split("."),f=u.length,o=u[f-2]+"."+u[f-1];document.cookie=t.storeKey+"="+encodeURIComponent(i)+e+"; path=/; domain="+o+";SameSite=Lax;"},t.readCookie=function(){for(var i,f=n.document.cookie.split(";"),e=t.storeRegex,r=0,u=f;r<u.length;r++)if(i=u[r],e.test(i))return decodeURIComponent(i.substring(i.indexOf("=")+1,i.length));return""},t.cookieExpireDays=365,t.storeKey="__CG",t.storeRegex=new RegExp("^(\\s)*"+t.storeKey+"=","i"),t}(),u=function(){function n(){}return n.getValue=function(t,r){var u=t.responseStart!==0;switch(r){case i.DNS:return n.getMetricValue(t.domainLookupEnd,t.domainLookupStart,u);case i.Connect:return n.getMetricValue(t.connectEnd,t.connectStart,u);case i.Load:return n.getMetricValue(t.responseEnd,t.responseStart,u);case i.Wait:return n.getMetricValue(t.responseStart,t.requestStart,u);case i.Start:return t.startTime;case i.Redirect:return n.getMetricValue(t.redirectEnd,t.redirectStart);case i.Duration:return t.duration;case i.SSL:if(t.secureConnectionStart)return u?t.connectEnd-t.secureConnectionStart:null}return 0},n.getMetricValue=function(n,t,i){if(i===void 0&&(i=!0),i){if(n>=0&&n>=t&&t>=0)return n-t}else return null},n.getRoundedValue=function(n){return n?Math.round(n):n},n.addScriptTag=function(n,t){var i=t.document.createElement("script");i.type="text/javascript";i.src=a+n;t.document.body.appendChild(i)},n.getQueryStringValue=function(n){for(var u=s.search.substring(1),r=u.split("&"),t,i=0;i<r.length;i++)if(t=r[i].split("="),t[0]==n)return t[1];return""},n.stopEvents=function(){t&&(t.eventManager.clear(),t.getEventTimingHandler().clear())},n}(),f;(function(n){n.UserId="u";n.SessionId="s";n.SessionTime="t";n.PageViewCount="c";n.UrlCheckSum="k";n.PostFlag="f"})(f||(f={})),function(n){n[n.GET=0]="GET";n[n.POST=1]="POST";n[n.HEAD=2]="HEAD";n[n.DELETE=3]="DELETE";n[n.OPTIONS=4]="OPTIONS";n[n.PUT=5]="PUT";n[n.TRACE=6]="TRACE";n[n.CONNECT=7]="CONNECT"}(l||(l={})),function(n){n[n.DNS=0]="DNS";n[n.Connect=1]="Connect";n[n.Load=2]="Load";n[n.Wait=3]="Wait";n[n.Start=4]="Start";n[n.Redirect=5]="Redirect";n[n.Duration=6]="Duration";n[n.SSL=7]="SSL"}(i||(i={}));var it=function(){function n(){this.userId=-1;this.sessionId=0;this.sessionTime=0;this.pageViewCount=0;this.viewCount=0;this.pageViewId=0;this.postFlag=-1;this.sendWaterfall=!1;this.exitToEntry=0}return n.prototype.resetViewCount=function(){this.viewCount=1},n.prototype.save=function(){var n=this.getText();p.save(n)},n.prototype.load=function(){var e=p.read(),o,r,u,s,i,t,h,n;if(!e)return!1;for(o=e.split(","),r=0,u=o;r<u.length;r++)if(s=u[r],i=s.split(":"),i.length===2){if(t=i[0],typeof t=="string"&&(t=t.trim()),h=i[1],t===f.UrlCheckSum){this.urlCheckSum=h;continue}if(n=parseInt(i[1],10),!isNaN(n))switch(t){case f.UserId:this.userId=n;break;case f.SessionId:this.sessionId=n;break;case f.SessionTime:this.sessionTime=n;break;case f.PageViewCount:this.pageViewCount=n;break;case f.PostFlag:this.postFlag=n}}return!0},n.prototype.getText=function(){var n=f.UserId+":"+this.userId+",";return n+=f.SessionId+":"+this.sessionId+",",n+=f.SessionTime+":"+this.sessionTime+",",n+=f.PageViewCount+":"+this.pageViewCount+",",n+=f.UrlCheckSum+":"+this.urlCheckSum+",",n+(f.PostFlag+":"+this.postFlag)},n}(),rt=function(){function i(){this.sessionExpire=18e5;this.store=new it}return i.prototype.updateSessionTime=function(){if(this.store){var n=(new Date).getTime();n-this.store.sessionTime>this.sessionExpire&&(this.store.sessionId=0);this.store.sessionTime=n;this.updateStore()}},i.prototype.updateStore=function(){this.store&&this.store.save()},i.prototype.initStore=function(){var i=this.store.load(),n,t;i&&this.store.postFlag==1&&(n=this.getUserId(r.sampleRate/100),t=n/(100/r.waterfallSampleRate),this.store.sendWaterfall=this.store.userId<=t)},i.prototype.resetPostFlag=function(){var n,t;if(this.store.postFlag=0,r.sampleRate<0){this.store.postFlag=-1;return}n=this.getUserId(r.sampleRate/100);this.store.userId<=n&&(this.store.postFlag=1,t=n/(100/r.waterfallSampleRate),this.store.sendWaterfall=this.store.userId<=t)},i.prototype.getReferrer=function(n){for(var i=this.getHostName(n).replace(":","-"),r=n.indexOf("?"),u=0,t=i.length;t<n.length;t++)u+=n.charCodeAt(t)%t;return i+"/"+(r<0?n.length:r)+"/"+n.length+"/"+u},i.prototype.getHostName=function(n){var i=n.indexOf("//")+2,t=n.indexOf("/",i);return i<2&&t==-1?n:(t==-1&&(t=n.length),n.substring(i,t))},i.prototype.init=function(){var r=t.data.start,i;return this.initStore(),this.store.userId==-1&&(i=this.store.userId,i!=v&&i>-1&&(this.store.userId=i,this.resetPostFlag())),(this.store.userId==-1||this.store.userId==v)&&(this.store.userId=this.getUserId(),this.resetPostFlag()),this.store.sessionId==0||r-this.store.sessionTime>this.sessionExpire?(this.store.sessionId=Math.floor(1+Math.random()*((Math.pow(2,32)-2)/2)),this.store.pageViewCount=1):(this.store.pageViewCount<65535&&this.store.pageViewCount++,this.getReferrer(n.document.referrer)==this.store.urlCheckSum&&this.store.sessionTime>0&&(this.store.exitToEntry=r-this.store.sessionTime)),this.store.sessionTime=(new Date).getTime(),this.store.pageViewId=Math.floor(1+Math.random()*((Math.pow(2,16)-2)/2)),this.store.urlCheckSum=this.getReferrer(n.location.href),this.store.resetViewCount(),this.updateStore(),this.store.load()},i.prototype.getUserId=function(n){return n===void 0&&(n=Math.random()),Math.floor(1+n*((Math.pow(2,64)-2)/2))},i.prototype.shouldPost=function(){return this.store.postFlag==1},i}(),w=function(){function n(n){this.char=n;this.children=[]}return n}(),b=function(){function n(){this.root=new w("");this.isReversed=!0}return n.prototype.add=function(n,t){var u,i,f,e,r;for(n===void 0&&(n=this.root),u=n.children,i=0,f=u;i<f.length;i++)if(e=f[i],e.char==t)return e;return r=new w(t),u.push(r),r.parent=n,r},n.prototype.toObject=function(){var n={},t=this.isReversed;return function i(n,r){var o=n.char=="",e,u,f;if(o)e=r;else{if(u=n.char,n.children.length==1)while(n.children.length==1)n=n.children[0],u=t?n.char+u:u+n.char;r[u]=n.data||{};e=r[u]}for(f=0;f<n.children.length;f++)i(n.children[f],e)}(this.root,n),n},n}(),k=function(){function n(n){this.dns=null;this.connect=null;this.load=null;this.wait=null;this.start=0;this.duration=0;this.redirect=0;this.ssl=null;this.url=n.name;var t=u.getValue;this.dns=t(n,i.DNS);this.connect=t(n,i.Connect);this.wait=t(n,i.Wait);this.load=t(n,i.Load);this.start=t(n,i.Start);this.duration=t(n,i.Duration);this.redirect=t(n,i.Redirect);this.ssl=t(n,i.SSL)}return Object.defineProperty(n.prototype,"url",{get:function(){return this._url},set:function(n){var i,t,u,r;n.indexOf("http://")!==-1?this.protocol=0:n.indexOf("https://")!==-1&&(this.protocol=1);i=n.split("/").slice(1,3).join("");t=i.indexOf(":");t!=-1&&(u=i.substr(t+1),r=parseInt(u),isNaN(r)||(this.port=r));n=n.substr(n.indexOf(i)+i.length);t=n.indexOf("?");t!=-1&&(n=n.substr(0,t));t=n.indexOf("#");t!=-1&&(n=n.substr(0,t));n=n.substr(0,64);this._url=n},enumerable:!0,configurable:!0}),n.prototype.translateForPost=function(){var r=Math.round,t=u.getRoundedValue,i={u:this.url,pr:this.protocol},n=function(n,t){typeof t!="number"||isNaN(t)||(i[n]=t)};return n("pt",this.port),n("dn",t(this.dns)),n("fc",t(this.connect)),n("ld",t(this.load)),n("wt",t(this.wait)),n("st",t(this.start)),n("rd",t(this.redirect)),n("dr",t(this.duration)),n("ssl",t(this.ssl)),i},n}(),d=function(n){function t(t,i,r){var u=n.call(this,i)||this;return u.responseTime=0,u.sendSize=0,u.responseSize=0,u.method=l[t.method.toUpperCase()],t.complete&&t.connectionEstablished&&(u.responseTime=t.complete-t.connectionEstablished),u.isSummary=r,r?(u.start=undefined,u.count=1):u.isAsync=t.isAsync,u.sendSize=t.sendSize||0,u.responseSize=t.responseSize||0,u}return __extends(t,n),t.prototype.update=function(n,t){var r=u.getValue;t.responseStart&&(this.dns+=r(t,i.DNS),this.connect+=r(t,i.Connect),this.wait+=r(t,i.Wait),this.load+=r(t,i.Load),this.ssl+=r(t,i.SSL));this.duration+=r(t,i.Duration);this.redirect+=r(t,i.Redirect);this.sendSize+=n.sendSize||0;this.responseSize+=n.responseSize||0;this.count++},t.prototype.translateForPost=function(){var t=n.prototype.translateForPost.call(this);return this.isSummary?t.n=this.count:t.ia=this.isAsync?1:0,t.md=this.method,t.rp=Math.round(this.responseTime),t.ss=this.sendSize,t.rs=this.responseSize,t},t}(k),ut=function(){function n(){this.count=0;this.dns=null;this.connect=null;this.load=null;this.wait=null;this.duration=0;this.redirect=0;this.ssl=null}return n.prototype.addAjaxItem=function(n,t){var i,r,u,f;if(this.update(t),i=new d(n,t,!0),typeof this._ajax=="undefined"){this._ajax=[];this._ajax.push(i);return}for(r=0,u=this._ajax;r<u.length;r++)if(f=u[r],f.url==i.url){f.update(n,t);return}this._ajax.length<10&&this._ajax.push(i)},n.prototype.update=function(n){var t=u.getValue;n.responseStart&&(this.dns+=t(n,i.DNS),this.connect+=t(n,i.Connect),this.wait+=t(n,i.Wait),this.load+=t(n,i.Load),this.ssl+=t(n,i.SSL));this.duration+=t(n,i.Duration);this.redirect+=t(n,i.Redirect);this.count++},n.prototype.translateForPost=function(){var n=u.getRoundedValue,f={n:this.count,dn:n(this.dns),fc:n(this.connect),ld:n(this.load),wt:n(this.wait),dr:n(this.duration),rd:n(this.redirect),ssl:n(this.ssl)},i,t,r,e;if(this._ajax){for(i=[],t=0,r=this._ajax;t<r.length;t++)e=r[t],i.push(e.translateForPost());f.ax=i}return f},n}(),ft=function(){function n(){this._resources=[]}return n.prototype.translateForPost=function(){for(var r,t=[],n=0,i=this._resources;n<i.length;n++)r=i[n],t.push(r.translateForPost());return t},n.prototype.addItem=function(n){var t=new k(n);this._resources.push(t)},n.prototype.addAjaxItem=function(n,t){var i=new d(n,t,!1);this._resources.push(i)},n}(),et=function(n){function t(){var t=n!==null&&n.apply(this,arguments)||this;return t.maxJsErrors=10,t.charCodes={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\","&":"%26"},t.strRegex=/["&\\\x00-\x1f\x7f-\x9f]/g,t}return __extends(t,n),t.prototype.toString=function(n,t){var i=this.translateForPost(n,t);return typeof JSON=="undefined"?this.jsonStringify(i):JSON.stringify(i)},t.prototype.strEscape=function(n){var i=this.charCodes[n],t;return i?i:(t=n.charCodeAt(0),"\\u00"+Math.floor(t/16).toString(16)+(t%16).toString(16))},t.prototype.jsonStringify=function(n){var t=[],i,u,e,r,f;switch(typeof n){case"string":return this.strRegex.test(n)?'"'+n.replace(this.strRegex,this.strEscape)+'"':'"'+n+'"';case"number":return isFinite(n)?String(n):"null";case"boolean":return String(n);case"object":if(!n)return"null";if(n.constructor===Date,typeof n.length=="number"&&!n.propertyIsEnumerable("length")){for(i=0,u=n;i<u.length;i++)e=u[i],t.push(this.jsonStringify(e));return"["+t.join(",")+"]"}for(r in n)typeof r=="string"&&(f=this.jsonStringify(n[r]),!f||t.push(this.jsonStringify(r)+":"+f));return"{"+t.join(",")+"}"}return""},t.prototype.translateForPost=function(n,t){var e=this.viewCount>1,i={},u,r,f;if(i.v=g,i.pt=this.postType,i.ui=this.userId,i.si=this.sessionId,i.di=this.siteId,i.pi=this.pageViewId,i.jsc=this.jsErrorCount||0,i.rf=this.referrer,i.pc=this.pageViewCount,i.vc=this.viewCount,i.rc=this.redirectCount||0,this.jsErrors&&this.jsErrors.length>0){for(u=[],r=0;r<Math.min(this.jsErrors.length,this.maxJsErrors);r++)u.push(this.translateErrorForPost(this.jsErrors[r]));i.jse=u}return this.hasErrors&&(i.ae=this.getErrors()),this.pageGroup&&(i.pg=this.pageGroup),this.variation&&(i.ab=this.variation),(this.resources||this.ajaxRequests)&&(f=this.translateResources(this.resources,this.ajaxRequests),i.res=f.summary,t&&(i.wf=f.waterfall)),typeof this.isNewView=="boolean"&&(i.nv=this.isNewView?1:0),this.hasIndicators&&(i.ind=this.getIndicators()),this.hasTracepoints&&(i.tra=this.getTracepoints()),this.isConversion&&(i.cv=this.isConversion?1:0,this.revenue&&(i.rv=this.revenue),this.revenueItems&&(i.ri=this.revenueItems)),i.np=this.isNewPageView?1:0,(n===PostType.OnLoad||n===PostType.OnAbort)&&(i.dh=this.screenHeight,i.dw=this.screenWidth,this.isNewPageView&&(i.dn=this.dns,i.fc=this.fullConnect,i.wt=this.wait,i.ld=this.load,i.de=this.domInteractive,i.dl=this.domLoaded,i.dc=this.docComplete,i.rp=this.response,i.cl=this.contentLoad,i.rd=this.redirect,i.rc=this.redirectCount||0,this.secureConnect&&(i.sc=this.secureConnect),this.exitToEntry&&(i.xe=this.exitToEntry),this.entryToOnLoad&&(i.el=this.entryToOnLoad),this.prerender&&(i.pr=this.prerender))),n===PostType.OnBeforeUnload&&(i.maf=this.markAboveTheFold,i.mfl=this.markFullyLoaded,i.mfv=this.markFullyVisible,i.mtu=this.markTimeToUserAction,i.tp=this.timeOnPage,i.tti=this.timeToInteract,i.et=this.engagementTime,i.fet=this.firstEngagementTime,i.fid=this.firstInputDelay,i.vct=this.visComplete,i.fid=this.firstInputDelay,e||(i.fp=this.firstPaint,i.fcp=this.firstContentPaint)),i},t.prototype.translateErrorForPost=function(n){var t={},i,r;return t.m=n.message,t.n=n.lineNumber,t.c=n.count+1,i=n.url,r=i.indexOf("?"),r!=-1&&(i=i.substr(0,r)),t.u=i,t},t.prototype.translateResources=function(n,t){var k=!!n,d=!!t,g,r,c,v,u,i,y,h,l,p,w,f,e,o,a;if(!k&&!d)return null;if(g=function(n){var r,u,f,i,e;if(!k||!d)return null;for(r=0,u=t;r<u.length;r++)if(f=u[r],i=f.url,i.indexOf("http")!=0&&(e=s.href.lastIndexOf("/"),i=s.href.substring(0,e)+"/"+i),i==n.name)return f;return null},r={},n)for(c=0,v=n;c<v.length;c++)(u=v[c],u)&&(i=u.name.split("/").slice(1,3).join(""),i&&i.length!=0)&&(y=i.indexOf(":"),y!=-1&&(i=i.substr(0,y)),r.hasOwnProperty(i)||(r[i]={summary:new ut,waterfall:new ft}),h=r[i],l=g(u),l?(h.summary.addAjaxItem(l,u),h.waterfall.addAjaxItem(l,u)):(h.summary.update(u),h.waterfall.addItem(u)));p=new b;for(f in r){for(e=undefined,o=f.length-1;o>=0;o--)a=f[o],e=p.add(e,a);e.data=r[f].summary.translateForPost()}w=new b;for(f in r){for(e=undefined,o=f.length-1;o>=0;o--)a=f[o],e=w.add(e,a);e.data=r[f].waterfall.translateForPost()}return{summary:p.toObject(),waterfall:w.toObject()}},t}(DataWrapper),ot=function(){function i(){var i=this,a,f,o,s,l;if(this.visitor=new rt,this.postUrl=r.postUrl,this.didSendInitial=!1,this.isDebugging=!1,this.countResourcesSent=0,this.didSoftNavigation=!1,this.currentUrl="",this.softNavigationStart=0,this.MaxNumberOfPerformanceMarks=1e3,this.updatePerformanceMetrics=function(t){if(e){var i=n.performance.timing,r=i.responseStart;t.dns=r?i.domainLookupEnd-i.domainLookupStart:null;t.fullConnect=r?i.connectEnd-i.connectStart:null;t.wait=r?i.responseStart-i.requestStart:null;t.load=r?i.responseEnd-i.responseStart:null;t.domInteractive=u.getMetricValue(i.domInteractive,i.navigationStart);t.domLoaded=u.getMetricValue(i.domContentLoadedEventStart,i.navigationStart);t.docComplete=u.getMetricValue(i.domComplete,i.navigationStart);t.response=u.getMetricValue(i.responseEnd,i.navigationStart);t.contentLoad=u.getMetricValue(i.loadEventStart,i.domLoading);t.redirect=i.redirectEnd-i.redirectStart;i.secureConnectionStart&&(t.secureConnect=i.connectEnd-i.secureConnectionStart)}},this.updateResources=function(t,u){if(e){var f=[];h&&(f=n.performance.getEntriesByType("resource"));t!=PostType.OnLoad&&(i.setClearResources(),r.clearResources&&n.performance.clearResourceTimings?(u.resources=f,n.performance.clearResourceTimings()):(u.resources=f.slice(i.countResourcesSent),i.countResourcesSent=f.length))}},this.getTimeOnPage=function(n){var t=i.getFocusAwayTime(n),r=i.getNavigationStart(n);return y()-r-t},this.getVisuallyComplete=function(){if(n.CPVisuallyComplete){var t=n.CPVisuallyComplete.getValue();if(typeof t=="number")return t}},this.updateEngagementMetrics=function(r,f){var o;if(h&&(o=n.performance.getEntriesByType("paint"),o&&o.length>0&&(r.firstPaint=i.getPaintTimings(o,"first-paint"),r.firstContentPaint=i.getPaintTimings(o,"first-contentful-paint"))),e){var c=n.performance.timing,s=u.getMetricValue(c.domContentLoadedEventEnd,c.navigationStart),l=tt.getLongTaskTime();r.timeToInteract=s&&s<l?l:s}t.getEventTimingHandler&&(r.engagementTime=t.getEventTimingHandler().getEngagementTime(),r.timeOnPage=i.getTimeOnPage(f),r.firstEngagementTime=i.getFirstEngagementTime(f));t.getInputDelay&&(r.firstInputDelay=t.getInputDelay().getFirstInputDelay())},this.getFirstEngagementTime=function(n){var r=i.getNavigationStart(n),u=t.getEventTimingHandler().getFirstEngagementTime();return u&&r?u-r:0},this.getNavigationStart=function(t){var r=e?n.performance.timing.navigationStart:0;return t?i.softNavigationStart:r},this.getElapsedTimeSinceLatestNavStart=function(){return i.didSoftNavigation&&e?i.softNavigationStart-n.performance.timing.navigationStart:0},this.getFocusAwayTime=function(){return t.getEventTimingHandler().getFocusAwayTime()||0},this.updateDebugData=function(){var n=i.createInitPostObject(PostType.OnBeforeUnload,!1),f=i.visitor.store.sendWaterfall||!!u.getQueryStringValue(r.waterfallParameter),e=n.toString(PostType.OnLoad,f);t.debugData=n;t.unloadDebugData=e},this.onPageLoad=function(){if(i.isDebugging){t.debugData=i.createInitPostObject(PostType.OnLoad,!1);t.updateDebugData=i.updateDebugData;t.sendData=function(){i.doPost(PostType.OnBeforeUnload,!1)};u.stopEvents();u.addScriptTag(r.debugUrl,n);return}i.visitor.updateSessionTime();i.doPost(PostType.OnLoad,!1)},this.captureSoftNavigations=function(){var r,u,f,e,o,s,h;(t.eventManager.add("hashchange",n,i.onSoftNavigation),r=n.history,r)&&(u="function",typeof r.go===u&&(f=r.go,r.go=function(n){i.onSoftNavigation();f.call(r,n)}),typeof r.back===u&&(e=r.back,r.back=function(){i.onSoftNavigation();e.call(r)}),typeof r.forward===u&&(o=r.forward,r.forward=function(){i.onSoftNavigation();o.call(r)}),typeof r.pushState===u&&(s=r.pushState,r.pushState=function(n,t,u){i.onSoftNavigation();s.call(r,n,t,u)}),typeof r.replaceState===u&&(h=r.replaceState,r.replaceState=function(n,t,u){i.onSoftNavigation();h.call(r,n,t,u)}))},this.onViewVisuallyComplete=function(){i.didSoftNavigation&&i.doPost(PostType.OnLoad,!0)},this.onSoftNavigation=function(){var r;if(n.CPVisuallyComplete){r=n.CPVisuallyComplete;r.onComplete(i.onViewVisuallyComplete)}i.doPost(PostType.OnBeforeUnload,i.didSoftNavigation);i.visitor.store.viewCount++;!r||n.setTimeout(function(){r.reset()},0);n.setTimeout(function(){if(i.softNavigationStart=y(),t.getEventTimingHandler){var n=t.getEventTimingHandler(),r=t.getInputDelay();n.startSoftNavigationCapture();r.startSoftNavigationCapture();n.resetSoftNavigationCapture()}},0);i.didSoftNavigation=!0},this.doPost=function(n,f){var e;if(i.visitor.shouldPost()){n!=PostType.OnBeforeUnload||t.data.loadFired||(n=PostType.OnAbort);i.didSendInitial?e=i.createDiffPostObject(n,f):(e=i.createInitPostObject(n,f),i.didSendInitial=!0);var o=i.visitor.store.sendWaterfall||!!u.getQueryStringValue(r.waterfallParameter),s=n==PostType.OnBeforeUnload||n==PostType.OnAbort,h=o&&s;i.makeRequest(n,e,h)}},t&&t.data){if(a=this.visitor.init(),this.isDebugging=!!u.getQueryStringValue(r.debugParameter),!this.isDebugging&&!a){u.stopEvents();return}this.captureSoftNavigations();f=!1;o=function(){f||(t.data.loadFired=!0,f=!0,i.onPageLoad())};t.data.loadFired||!n.document||(t.data.loadFired=n.document.readyState=="complete");t.data.loadFired?o():t.eventManager.add(c.Load,parent.window,o);s=!1;l=function(){s||(s=!0,i.doPost(PostType.OnBeforeUnload,!1))};t.eventManager.add(c.BeforeUnload,n,l);t.eventManager.add(c.Unload,n,l)}}return i.prototype.createInitPostObject=function(i,u){var f=this.createBasePostObj(i,!0,u),s,c,o;return this.updatePerformanceMetrics(f),s=this.visitor.store,s.exitToEntry>0&&(f.exitToEntry=s.exitToEntry),c=t.data.loadTime-t.data.start,c>0&&(f.entryToOnLoad=c),document.webkitVisibilityState==="prerender"&&(f.prerender=1),e&&(o=void 0,h&&(o=n.performance.getEntriesByType("resource"),f.resources=o),i!=PostType.OnLoad&&(this.setClearResources(),r.clearResources&&n.performance.clearResourceTimings?n.performance.clearResourceTimings():this.countResourcesSent=o.length)),f},i.prototype.createDiffPostObject=function(i,r){var u=this.createBasePostObj(i,!1,r),f;return this.updateResources(i,u),this.updateEngagementMetrics(u,r),this.addPerformanceMarksToPostData(n.performance,u),f=this.getVisuallyComplete(),f&&(u.visComplete=f),t.data.jsCount>0&&(u.jsErrorCount=t.data.jsCount,u.jsErrors=t.data.jsErrors,t.clearErrors()),t.data.ajax&&(u.ajaxRequests=t.data.ajax.slice(),t.clearAjax()),u},i.prototype.createBasePostObj=function(i,u,f){var e=new et,o;return e.postType=i,e.isNewPageView=u,e.siteId=r.siteId,e.referrer=encodeURI(n.location.href),e.sampleRate=r.sampleRate,e.waterfallSampleRate=r.waterfallSampleRate,o=this.visitor.store,e.userId=o.userId,e.sessionId=o.sessionId,e.pageViewId=o.pageViewId,e.pageViewCount=o.pageViewCount,e.viewCount=o.viewCount,e.screenHeight=screen.height,e.screenWidth=screen.width,this.currentUrl=e.referrer,e.referrer=i===PostType.OnBeforeUnload||i===PostType.OnAbort?this.currentUrl||encodeURI(n.location.href):encodeURI(n.location.href),f&&(e.isNewView=i==PostType.OnLoad),t.hasInsight&&(this.addInsightForPost(e),t.clearInfo()),e},i.prototype.addPerformanceMarksToPostData=function(n,t){var i,f,o,r,u,s;if(e&&n.getEntriesByType&&(i=n.getEntriesByType("mark"),i&&i.length>0&&i.length<this.MaxNumberOfPerformanceMarks))for(f=this.getElapsedTimeSinceLatestNavStart(),o=i.filter(function(n){return n.startTime!=null&&n.startTime>=f}),r=0,u=o;r<u.length;r++)s=u[r],this.addMarkToPostData(s,t)},i.prototype.addMarkToPostData=function(n,t){var i=u.getRoundedValue(n.startTime+n.duration);switch(n.name){case"mark_fully_loaded":t.markFullyLoaded=i;break;case"mark_fully_visible":t.markFullyVisible=i;break;case"mark_above_the_fold":t.markAboveTheFold=i;break;case"mark_time_to_user_action":t.markTimeToUserAction=i}},i.prototype.getPaintTimings=function(n,t){var i=n.filter(function(n){return n.name===t});if(i&&i.length>0&&i[0].startTime)return Math.round(i[0].startTime)},i.prototype.setClearResources=function(){!n.__cpPreventResourceClear||(r.clearResources=n.__cpPreventResourceClear===!1)},i.prototype.addInsightForPost=function(n){var f=t.info,r,s,o,e,u,h,c,i;for(r in f)switch(r){case"appError":if(i=f[r],i&&typeof i=="object")for(e in i)(o=Number(e),isNaN(o))||(u=i[e],u&&typeof u=="string"&&(s=u,s.length>32&&(s=s.substring(0,32)),n.addError(e,s)));break;case"conversion":if(i=f[r],n.isConversion=!0,i&&typeof i=="object")for(e in i)(o=Number(e),isNaN(o))||(u=i[e],u&&typeof u=="number"&&(n.revenue=o,n.revenueItems=u));break;case"indicator":h=this.buildInsight(f[r],0);h[0]&&n.addIndicator(h[1]);break;case"tracepoint":c=this.buildInsight(f[r],"");c[0]&&n.addTracepoint(c[1]);break;case"pageGroup":i=f[r];i!==undefined&&typeof i=="string"&&(n.pageGroup=i);break;case"variation":i=f[r];i!==undefined&&typeof i=="string"&&(n.variation=i)}},i.prototype.buildInsight=function(n,t){var f={},i=!1,r,u;if(n&&typeof n=="object")for(r in n)r&&(u=n[r],u&&typeof u==typeof t&&(f[r]=u,i=!0));return i?[i,f]:[i,f]},i.prototype.makeRequest=function(t,i,r){var f=i.toString(t,r),u;n.navigator&&typeof n.navigator.sendBeacon=="function"?n.navigator.sendBeacon(this.postUrl,f):(u=new XMLHttpRequest,window.XDomainRequest&&(u=new window.XDomainRequest,u.timeout=0,u.onload=function(){},u.onerror=function(){},u.ontimeout=function(){},u.onprogress=function(){}),u.open("POST",this.postUrl,!1),u.setRequestHeader?u.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"):null,u.send(f),u=null)},i}(),ht=new ot}}();var windowItem=parent.window||window;windowItem.CPVisuallyComplete=function(){var t=function(){function n(){var n=this;this.targetWindow=windowItem;this.mutationObserver=undefined;this.start=0;this.waitMs=2e3;this.maxResourceTiming=0;this.mutationObserverVal=0;this.scroll="scroll";this.click="click";this.maxDiffBetweenMutation=500;this.disconnectObserverTimeout=5e3;this.removeListeners=function(){document.removeEventListener(n.scroll,n.clear);document.removeEventListener(n.click,n.clear)};this.addListeners=function(){document.addEventListener(n.scroll,n.clear);document.addEventListener(n.click,n.clear)};this.clear=function(){clearTimeout(n.timeout);n.removeListeners();n.trigger()};this.onLoad=function(){n.timeout=setTimeout(function(){n.removeListeners();n.calculate()},n.waitMs)};this.calculate=function(){if(!n.targetWindow.performance){n.trigger();return}n.calcResourceBasedVisuallyCompleteTime();n.trigger()};this.getPerformanceTime=function(){return n.targetWindow.performance.now()};this.resetValueOnSoftNav=function(){n.mutationObserverVal=0;n.maxResourceTiming=0;n.softNav=!1};this.mutationCallback=function(t){t.forEach(function(t){if(n.targetWindow.performance&&t.addedNodes.length>0){var i=n.getPerformanceTime();n.softNav&&n.resetValueOnSoftNav();i=i-n.start;(n.mutationObserverVal===0||i-n.mutationObserverVal<=n.maxDiffBetweenMutation)&&(n.mutationObserverVal=Math.round(i))}})};this.initMutationObserver=function(){var t=n.targetWindow.MutationObserver||n.targetWindow.WebKitMutationObserver||n.targetWindow.MozMutationObserver;t&&(n.mutationObserver=new t(n.mutationCallback),n.observe())};this.trigger=function(){if(n.callback){var t=n.getValue();n.callback(t)}};this.observe=function(){n.mutationObserver.observe(n.targetWindow.document,{childList:!0,attributes:!0,characterData:!0,subtree:!0,attributeOldValue:!0,characterDataOldValue:!0});setTimeout(function(){n.mutationObserver.disconnect()},n.disconnectObserverTimeout)};this.getValue=function(){if(n.maxResourceTiming||n.mutationObserverVal){var t=0;return n.maxResourceTiming&&n.mutationObserverVal?t=Math.max(n.maxResourceTiming,n.mutationObserverVal):n.maxResourceTiming?t=n.maxResourceTiming:n.mutationObserverVal&&(t=n.mutationObserverVal),t}return undefined};this.onComplete=function(t){n.callback=t};this.reset=function(){n.softNav=!0;n.targetWindow.performance&&(n.start=n.getPerformanceTime(),n.mutationObserver.disconnect(),n.observe(),n.onLoad())};this.captureSoftNavigations=function(){var t,i,r,u,f,e,o;n.targetWindow.HashChangeEvent&&!n.targetWindow.RProfiler&&(n.addEvent("hashchange",n.targetWindow,n.reset),t=n.targetWindow.history,t)&&(i="function",typeof t.go===i&&(r=t.go,t.go=function(i){n.reset();r.call(t,i)}),typeof t.back===i&&(u=t.back,t.back=function(){n.reset();u.call(t)}),typeof t.forward===i&&(f=t.forward,t.forward=function(){n.reset();f.call(t)}),typeof t.pushState===i&&(e=t.pushState,t.pushState=function(i,r,u){n.reset();e.call(t,i,r,u)}),typeof t.replaceState===i&&(o=t.replaceState,t.replaceState=function(i,r,u){n.reset();o.call(t,i,r,u)}))};this.calcResourceBasedVisuallyCompleteTime=function(){n.maxResourceTiming=n.getMaxResourceTime()};this.initMutationObserver();this.captureSoftNavigations();this.init()}return n.prototype.init=function(){var n=this.targetWindow.document;n.readyState=="complete"?this.onLoad():this.targetWindow.addEventListener("load",this.onLoad);this.removeListeners();this.addListeners()},n.prototype.getMaxResourceTime=function(){for(var r,n,t=0,f=["img","iframe","css","script","subdocument"],e=this.targetWindow.performance.getEntriesByType("resource"),i=0,u=e;i<u.length;i++)r=u[i],n=r.responseEnd,f.indexOf(r.initiatorType)>-1&&n>this.start&&(n=n-this.start,(!t||n>t)&&(t=Math.round(n)));return t},n.prototype.addEvent=function(n,t,i){this.targetWindow.attachEvent?t.attachEvent("on"+n,i):t.addEventListener(n,i,!1)},n.prototype.getResourceTimings=function(){try{return this.targetWindow.performance.getEntriesByType("resource")}catch(t){}},n.prototype.getFirstPaintTime=function(){var r=0,n,t,i;try{n=this.targetWindow.performance.getEntriesByType("paint");n&&n.length>0&&(t=n.filter(function(n){return n.name==="first-paint"}),t&&t.length>0&&t[0].startTime&&(r=t[0].startTime),i=n.filter(function(n){return n.name==="first-contentful-paint"}),i&&i.length>0&&i[0].startTime&&(r=i[0].startTime))}catch(u){}return r},n}(),n=new t;return{getValue:n.getValue,onComplete:n.onComplete,reset:n.reset}}();